<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Professor Noli Brazil" />

<meta name="date" content="2024-04-24" />

<title>Logistic Regression</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GEO 200CN: Spring 2024</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
<li>
  <a href="hw_guidelines.html">Assignment Guidelines</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="getting_started.html">Getting Started</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="inference.html">Statistical Inference</a>
    </li>
    <li>
      <a href="hypothesis.html">Hypothesis Testing</a>
    </li>
    <li>
      <a href="linearregression.html">Linear Regression</a>
    </li>
    <li>
      <a href="linearregression2.html">More Linear Regression</a>
    </li>
    <li>
      <a href="logistic.html">Logistic Regression</a>
    </li>
    <li>
      <a href="introspatial.html">Intro to Spatial Data</a>
    </li>
    <li>
      <a href="pointpatterns.html">Point Pattern Analysis</a>
    </li>
    <li>
      <a href="spatialautocorrelation.html">Spatial Autocorrelation</a>
    </li>
    <li>
      <a href="spatialreg.html">Spatial Regression</a>
    </li>
    <li>
      <a href="prediction.html">Prediction Modelling</a>
    </li>
    <li>
      <a href="modelselection.html">Model Selection</a>
    </li>
    <li>
      <a href="interpolation.html">Spatial Interpolation</a>
    </li>
    <li>
      <a href="kriging.html">Kriging</a>
    </li>
    <li>
      <a href="regtrees.html">Regression Trees</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="tips.html">R Tips</a>
    </li>
    <li>
      <a href="data_wrangling.html">Data Wrangling</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Logistic Regression</h1>
<h3 class="subtitle"><font size="4">GEO 200CN - Quantitative
Geography</font></h3>
<h4 class="author">Professor Noli Brazil</h4>
<h4 class="date">April 24, 2024</h4>

</div>


<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 1px solid black;
margin-left: 25px;
border-radius: 5px;
font-style: normal;
}

.figure {
   margin-top: 20px;
   margin-bottom: 20px;
}

h1.title {
  font-weight: bold;
  font-family: Arial;  
}

h2.title {
  font-family: Arial;  
}

</style>
<style type="text/css">
#TOC {
  font-size: 13px;
  font-family: Arial;
}
</style>
<p><br />
</p>
<p>In the past couple of labs we’ve learned how to run and interpret
linear regression models. Linear regression models are used when your
outcome is a continuous numeric variable. But what if you’re outcome is
categorical? Specifically, it has two classes, Yes or No. In this case,
we use the logistic regression model. The objectives of this lab are as
follows</p>
<ol style="list-style-type: decimal">
<li>Learn how to run and evaluate a logistic regression model</li>
<li>Learn how to calculate and evaluate model fit</li>
</ol>
<p>To help us accomplish these learning objectives, we will examine the
association between landslide occurrence and various environmental
factors in the <a
href="https://storymaps.arcgis.com/stories/62705877a9f64ac5956a64230430c248">San
Pedro Creek Watershed</a> in Pacifica, CA.</p>
<div style="margin-bottom:25px;">

</div>
<div id="installing-and-loading-packages" class="section level2">
<h2><strong>Installing and loading packages</strong></h2>
<p><br />
</p>
<p>We introduce one new package in today’s lab</p>
<pre class="r"><code>install.package(&quot;lmtest&quot;)</code></pre>
<p>Load this package along with others we need.</p>
<pre class="r"><code>library(tidyverse)
library(lmtest)</code></pre>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="why-logistic-regression" class="section level2">
<h2><strong>Why logistic regression?</strong></h2>
<p><br />
</p>
<p>The reasons why you run a logistic regression are the same as the
reasons for <a
href="https://geo200cn.github.io/linearregression.html#Why_linear_regression">running
a regular linear regression</a>. However, there is one additional
important motivation: we want to model the relationship between a set of
independent variables and a <em>binary</em> outcome.</p>
<p>In many situations in your work as a Geographer, your outcome will be
of a qualitative nature. When we speak of qualitative outcomes, we
generally are concerned with the observation of:</p>
<ul>
<li>A particular classification
<ul>
<li>Invasive species or not; urban or not</li>
</ul></li>
<li>A particular behavior
<ul>
<li>Migrated or not; fire ignition</li>
</ul></li>
<li>A transition
<ul>
<li>Riverbank erosion; employed to unemployed;</li>
</ul></li>
<li>A threshold characteristic
<ul>
<li>Income below poverty level; concentrations exceeding a particular
anthropogenic pollution threshold</li>
</ul></li>
</ul>
<p>In general, each of these outcomes would be coded as a binary
variable (1 or 0; Yes or No). You can use a linear regression to model a
binary outcome, but you’ll typically break the assumption of
homoskedastic residuals and you may get predictions outside of 1 or 0.
That’s why you’ll need to turn to logistic regression to model the
relationship.</p>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="bring-in-the-data" class="section level2">
<h2><strong>Bring in the data</strong></h2>
<p><br />
</p>
<p>Download the file <em>landslides.csv</em> from Canvas in the Week 4
Lab and Assignment folder. Bring in the file in</p>
<pre class="r"><code>landslides &lt;- read_csv(&quot;landslides.csv&quot;)</code></pre>
<p>The data contain various locations in the San Pedro Creek Watershed
in Pacifica, CA. The main goal of the analysis is to examine the
characteristics that are associated with landslide occurrence.
Landslides were detected on aerial photography from 1941, 1955, 1975,
1983, and 1997, and confirmed in the field during a study in the early
2000’s. We’ll create a logistic regression to compare landslide
probability to various environmental factors. We’ll use elevation
<em>elev</em>, slope <em>slope</em>, <a
href="https://earthquake.usgs.gov/education/geologicmaps/hillshades.php">hillshade</a>
<em>hillshade</em>, distance to nearest stream <em>stD</em>, distance to
nearest trail <em>trD</em>, and the results of a physical model
predicting slope stability as a <a
href="https://www.mdpi.com/1099-4300/17/6/4271">stability index</a>
<em>SI</em>.</p>
<p>Our research question is: What environmental characteristics are
associated with landslide occurrence?</p>
<p>We will be diving into spatial data next lab, but that should not
stop us from doing some rudimentary mapping. Specifically, we have
latitude and longitude points for each location in the dataset, so we
can map the data using our good friend <code>ggplot()</code>. We’ll
indicate which area experienced a landslide or not using the variable
<em>IsSlide</em>. We need to convert it to a factor to “color” it as a
categorical.</p>
<pre class="r"><code>ggplot(landslides) +
  geom_point(mapping = aes(x = lon,
                           y = lat, col = as.factor(IsSlide))) +
  xlab(&quot;Longitude&quot;) +
  ylab(&quot;Latitude&quot;) +
  labs(color = &quot;Landslide&quot;)</code></pre>
<p><img
src="logistic_files/figure-html/unnamed-chunk-4-1.png" /><!-- --></p>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="simple-logistic-regression" class="section level2">
<h2><strong>Simple Logistic Regression</strong></h2>
<p><br />
</p>
<p>We first examine the distribution of our binary dependent variable
<em>IsSlide</em>. We create a bar chart showing the distribution of the
landslide indicator.</p>
<pre class="r"><code>landslides %&gt;%
  group_by(IsSlide) %&gt;%
  summarize (n = n()) %&gt;%
  mutate(freq = n / sum(n))  %&gt;%
  ggplot() +
    geom_bar(mapping=aes(x=as.factor(IsSlide), y=freq),stat=&quot;identity&quot;) +
    xlab(&quot;Landslide&quot;)</code></pre>
<p><img
src="logistic_files/figure-html/unnamed-chunk-5-1.png" /><!-- --></p>
<p>Let’s now run a logistic regression model. We’ll start simple,
regressing <em>IsSlide</em> on <em>slope</em>. Instead of using the
function <code>lm()</code> to run a logistic regression model as we did
when running linear regression models, we will use the function
<code>glm()</code>, which stands for Generalized Linear Models.
<code>glm()</code> is similar to <code>lm()</code>, but gives us the
option of a variety of families to use in fitting the model (the shape
that we hypothesize represents the shape of the function <em>f</em> that
defines the relationship between Y and X).</p>
<p>We specify a family by using the argument <code>family =</code>. If
we wanted a standard linear regression, which assumes a normal
distribution, <code>family</code> will equal <code>gaussian</code>
(fancy word for normal). For a list of <code>glm</code> families, check
the help documentation <code>? glm</code>. We use
<code>family = binomial</code> for a logistic regression.</p>
<pre class="r"><code>logit1.fit &lt;- glm(IsSlide ~ slope, 
                  family = binomial, 
                  data = landslides)</code></pre>
<p>We can summarize the modelling results using <code>summary()</code>.
The resulting output is very similar to the output from
<code>lm()</code>.</p>
<pre class="r"><code>summary(logit1.fit)</code></pre>
<pre><code>## 
## Call:
## glm(formula = IsSlide ~ slope, family = binomial, data = landslides)
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -3.39142    0.37008  -9.164   &lt;2e-16 ***
## slope        0.13471    0.01387   9.715   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 668.29  on 483  degrees of freedom
## Residual deviance: 513.54  on 482  degrees of freedom
## AIC: 517.54
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p><br></p>
<p class="comment">
<strong>Question 1</strong>: What is the interpretation of the
<em>slope</em> coefficient?
</p>
<p><br></p>
<p>Let’s compare our results to those from an OLS regression model. An
OLS for a binary response variable is known as a linear probability
model. We use <code>glm()</code> again, but this time use the (default)
Gaussian distribution.</p>
<pre class="r"><code>ols.fit &lt;-glm(IsSlide ~ slope, 
              family = gaussian, 
              data = landslides)</code></pre>
<p>and a summary</p>
<pre class="r"><code>summary(ols.fit)</code></pre>
<pre><code>## 
## Call:
## glm(formula = IsSlide ~ slope, family = gaussian, data = landslides)
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.076552   0.044594  -1.717   0.0867 .  
## slope        0.023734   0.001767  13.429   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 0.181679)
## 
##     Null deviance: 120.331  on 483  degrees of freedom
## Residual deviance:  87.569  on 482  degrees of freedom
## AIC: 552.06
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<p><br></p>
<p class="comment">
<strong>Question 2</strong>: What is the interpretation of the
<em>slope</em> coefficient in ols.fit?
</p>
<p><br></p>
<p>You can create a plot like the one showed in Handout 5 (right hand
plot) by predicting the probability of a landslide for given values of
<em>slope</em>. The minimum and maximum slope for our data set are 0 and
42.29, respectively, so let’s predict landslide occurence for slopes
between 0 to 43 using the <code>predict()</code> function. The function
below tells R to give predicted landslide occurrence for values of
<em>slope</em> between 0 and 43.</p>
<pre class="r"><code>pfit1 &lt;- predict(logit1.fit, 
                 slope = c(0:43))</code></pre>
<p>In predicting using a regression model, you can either predict
landslides for the 484 observations in the original data set or predict
for a new set of observations. In the code above, we are predicting for
a new set of observations - areas with slopes between 0 and 43 - i.e. 0,
1, 2, 3 … 41, 42, and 43.</p>
<p>Let’s get a summary of our predicted values</p>
<pre class="r"><code>summary(pfit1)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -3.3914 -1.1843  0.0494 -0.3301  0.7812  2.3059</code></pre>
<p>We get values ranging from -3.4 to 2.3. But, these are not
probabilities. Remember, as described in the handout, the response
variable is modelled as a logit, so R will give us logits in return. To
convert the logit to a probability, use the argument
<code>type = "response"</code> inside <code>predict()</code></p>
<pre class="r"><code>pfit1 &lt;- predict(logit1.fit, 
                 data.frame(slope = c(0:43)), 
                 type = &quot;response&quot;)
summary(pfit1)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.03256 0.12543 0.37882 0.42496 0.72158 0.91692</code></pre>
<p>The predicted probability of a landslide ranges from 3.3% to
91.7%.</p>
<p><br></p>
<p class="comment">
<strong>Question 3</strong>: Create a plot similar to the one shown in
this week’s handout (right hand plot) showing the predicted
probabilities from logit1.fit and the observed data.
</p>
<p class="comment">
<strong>Question 4</strong>: Create a plot similar to the one shown in
this week’s handout (left hand plot) showing the predicted probabilities
from ols.fit and the observed data.
</p>
<p><br></p>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="multiple-logistic-regression" class="section level2">
<h2><strong>Multiple Logistic Regression</strong></h2>
<p><br />
</p>
<p>We now move to the multiple logistic regression framework by adding
more than one independent variable. Let’s add the variable
<em>hillshade</em>, which is a categorical variable (<em>High</em>,
<em>Mid</em>, and <em>Low</em>).</p>
<pre class="r"><code>logit2.fit &lt;- glm(IsSlide ~ slope + hillshade, 
                  family = binomial, 
                  data = landslides)
summary(logit2.fit)</code></pre>
<pre><code>## 
## Call:
## glm(formula = IsSlide ~ slope + hillshade, family = binomial, 
##     data = landslides)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -3.18010    0.44451  -7.154 8.42e-13 ***
## slope         0.14545    0.01582   9.195  &lt; 2e-16 ***
## hillshadeLow -0.92891    0.30165  -3.079  0.00207 ** 
## hillshadeMid -0.49244    0.27044  -1.821  0.06862 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 668.29  on 483  degrees of freedom
## Residual deviance: 503.68  on 480  degrees of freedom
## AIC: 511.68
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Let’s calculate the predicted probability of a landslide at each
value of <em>hillshade</em>, holding the slope at its mean. We need to
create a data frame containing the values for <em>slope</em> and
<em>hillshade</em> that we want to predict for. What are the categories
of <em>hillshade</em>?</p>
<pre class="r"><code>table(landslides$hillshade)</code></pre>
<pre><code>## 
## High  Low  Mid 
##  121  121  242</code></pre>
<p>Let’s save these categories in a vector.</p>
<pre class="r"><code>hillshade &lt;- c(&quot;High&quot;, &quot;Mid&quot;, &quot;Low&quot;)</code></pre>
<p>Now you need to create a data frame containing the vector
<em>hillshade</em> we created above as one column and the overall mean
of <em>slope</em> as another column (name the column <em>slope</em>
because it needs to match the variable name used in the prediction
model). So you should have a 3 x 2 data frame. Then plug this data frame
into the <code>predict()</code> function following what we did
earlier.</p>
<p><br></p>
<p class="comment">
<strong>Question 5</strong>: What is the difference in the probability
of a landslide between a Low hillshade area and a High hillshade area
holding the slope at its mean?
</p>
<p><br></p>
<p>Handout 5 goes through the various ways we can interpret logistic
regression coefficients. We already went through a few above. What about
the odds ratio interpretation?</p>
<p><br></p>
<p class="comment">
<strong>Question 6</strong>: Convert the logit2.fit coefficients to
interpret them as the change in the odds ratio with a one unit increase
in the independent variables. For a one unit increase in slope, the odds
of a landslide (versus no landslide) increase by a factor of what
amount?
</p>
<p><br></p>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="goodness-of-fit" class="section level2">
<h2><strong>Goodness of fit</strong></h2>
<p><br />
</p>
<p>The Handout goes through measures of best fit for a logistic
regression model. Fortunately, some of these measures are reported in
the model summary. Let’s run a multiple logistic regression model adding
more variables to the model. Below, we’ve added curvature, elevation,
distance to the nearest stream, and distance to the nearest trail.</p>
<pre class="r"><code>logit3.fit&lt;- glm(IsSlide ~ slope + hillshade + curv + elev + stD + trD, 
                 family = binomial, 
                 data = landslides)</code></pre>
<p>How does this model compare to one that also includes the slope
stability index?</p>
<pre class="r"><code>logit4.fit&lt;- glm(IsSlide ~ slope + hillshade + curv + elev + stD + trD + SI, 
                 family = binomial, 
                 data = landslides)</code></pre>
<p>Executing <code>summary()</code> on these results will give us some
but not all of the fit measures discussed in the handout. The likelihood
ratio test can be run using the function <code>lrtest()</code>, which is
part of the <strong>lmtest</strong> package. The function allows you
compare the fit between two different models.</p>
<p><br></p>
<p class="comment">
<strong>Question 7</strong>: What are the null and alternative
hypotheses for the Likelihood ratio test?
</p>
<p class="comment">
<strong>Question 8</strong>: Based on the fit measures discussed in the
handout, which model, logit3.fit and logit4.fit, provides the best fit?
Explain why.
</p>
<p><br></p>
<hr />
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br />This
work is licensed under a
<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative
Commons Attribution-NonCommercial 4.0 International License</a>.</p>
<p>Website created and maintained by <a
href="https://nbrazil.faculty.ucdavis.edu/">Noli Brazil</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>


</body>
</html>
