<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Kenji Tomari" />


<title>Lab Lecture 5</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GEO 200CN: Winter 2020</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
<li>
  <a href="hw_guidelines.html">Assignment Guidelines</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="getting_started.html">Getting Started</a>
    </li>
    <li>
      <a href="tidyr.html">Intro to tidyverse</a>
    </li>
    <li>
      <a href="central.html">Sampling, CIs, CLT</a>
    </li>
    <li>
      <a href="hypothesis.html">Hypothesis Testing</a>
    </li>
    <li>
      <a href="spatialsf.html">Mapping in sf</a>
    </li>
    <li>
      <a href="pointpatterns.html">Point Pattern Analysis</a>
    </li>
    <li>
      <a href="spatialautocorrelation.html">Spatial Autocorrelation</a>
    </li>
    <li>
      <a href="linearregression.html">Linear Regression I</a>
    </li>
    <li>
      <a href="linearregression2.html">Linear Regression II</a>
    </li>
    <li>
      <a href="spatialreg.html">Spatial Regression</a>
    </li>
    <li>
      <a href="spatialheterogeneity.html">Spatial Heterogeneity</a>
    </li>
    <li>
      <a href="classification.html">Classification</a>
    </li>
    <li>
      <a href="resampling.html">Resampling and Selection</a>
    </li>
    <li>
      <a href="interpolation.html">Interpolation</a>
    </li>
    <li>
      <a href="kriging.html">Kriging</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lab Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Lab_Week1.html">Lab Lecture - 1</a>
    </li>
    <li>
      <a href="Lab_Week2.html">Lab Lecture - 2</a>
    </li>
    <li>
      <a href="Lab_Week3.html">Lab Lecture - 3</a>
    </li>
    <li>
      <a href="Lab_Week4.html">Lab Lecture - 4</a>
    </li>
    <li>
      <a href="Lab_Week5.html">Lab Lecture - 5</a>
    </li>
    <li>
      <a href="Lab_Week6.html">Lab Lecture - 6</a>
    </li>
    <li>
      <a href="Lab_Week7.html">Lab Lecture - 7</a>
    </li>
    <li>
      <a href="Lab_Week8.html">Lab Lecture - 8</a>
    </li>
    <li>
      <a href="Lab_Week9.html">Lab Lecture - 9</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a></a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Lab Lecture 5</h1>
<h4 class="author">Kenji Tomari</h4>

</div>


<div id="part-1" class="section level1">
<h1>Part 1</h1>
<p>Below is a run through of Part 1 of Assignment 5.</p>
<pre class="r"><code>counties &lt;- st_read(&quot;countiescovid.shp&quot;)</code></pre>
<pre><code>## Reading layer `countiescovid&#39; from data source `/Users/noli/Documents/UCD/teaching/GEO 200CN/lab/geo200cn.github.io/countiescovid.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 3108 features and 5 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -2031905 ymin: -2114925 xmax: 2516374 ymax: 732103.3
## epsg (SRID):    NA
## proj4string:    +proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs</code></pre>
<pre class="r"><code>counties.sp &lt;- as(counties, &quot;Spatial&quot;)</code></pre>
<pre class="r"><code># Let&#39;s just look at California.
ca &lt;- counties %&gt;%
  filter(state == &quot;California&quot;)

ca.sp &lt;- ca %&gt;%
  as(&quot;Spatial&quot;)</code></pre>
<pre class="r"><code># How many counties in CA?
nrow(ca)</code></pre>
<pre><code>## [1] 58</code></pre>
<pre class="r"><code># quick map
ggplot() +
  geom_sf(data=ca, mapping = aes(fill = log(cases)), color = &quot;red&quot;)</code></pre>
<p><img src="Lab_Week5_files/figure-html/unnamed-chunk-5-1.png" /><!-- --></p>
<div id="grab-coordinates" class="section level2">
<h2>Grab Coordinates</h2>
<p>Before I begin the rest of the steps, I’ll get the centroids.</p>
<pre class="r"><code># get centroids of polygons
ca.coords &lt;- coordinates(ca.sp)</code></pre>
</div>
<div id="queen-contiguity" class="section level2">
<h2>Queen Contiguity</h2>
<p>Here we define the neighborhood using Queen Contiguity, and from this definition we assign weights to neighbors, and finally use Monte Carlo simulation to calculate the significance of our test of spatial autocorrelation (Moran’s I).</p>
<pre class="r"><code># create neighborhood matrix
# Note that strictly speaking, the R object is not matrix
ca_q_nb &lt;- poly2nb(ca.sp, queen=T)
ca_q_nb</code></pre>
<pre><code>## Neighbour list object:
## Number of regions: 58 
## Number of nonzero links: 276 
## Percentage nonzero weights: 8.204518 
## Average number of links: 4.758621</code></pre>
<pre class="r"><code># head
# take a look at the first 6 counties in the neighborhood matrix
ca_q_nb[1:6]</code></pre>
<pre><code>## [[1]]
## [1]  9 28 39 49 57
## 
## [[2]]
## [1]  3 10 11 26 35
## 
## [[3]]
## [1]  2  5 11 20 35 55
## 
## [[4]]
## [1]  7 27 34 37
## 
## [[5]]
## [1]  3 20 24 55
## 
## [[6]]
## [1] 12 26 38 47 54 56</code></pre>
<pre class="r"><code># create spatial weights matrix
# Note that strictly speaking, the R object is not matrix
ca_q_w &lt;- nb2listw(ca_q_nb, style=&quot;W&quot;, zero.policy= TRUE)
ca_q_w</code></pre>
<pre><code>## Characteristics of weights list object:
## Neighbour list object:
## Number of regions: 58 
## Number of nonzero links: 276 
## Percentage nonzero weights: 8.204518 
## Average number of links: 4.758621 
## 
## Weights style: W 
## Weights constants summary:
##    n   nn S0      S1       S2
## W 58 3364 58 26.8846 238.3498</code></pre>
<p>Note, you may run across an error when running this code above. When I run <code>ca_q_w</code> by itself, its actually invoking the <code>print</code> function, but specified to work with the output of <code>nb2listw</code>. So, you need to tell it to ignore regions with no neighbors, just like you did in <code>nb2listw</code>. So instead, you could type <code>print(ca_q_w, zero.policy = TRUE)</code>.</p>
<pre class="r"><code># quick look at the weights
ca_q_w$weights[1:6]</code></pre>
<pre><code>## [[1]]
## [1] 0.2 0.2 0.2 0.2 0.2
## 
## [[2]]
## [1] 0.2 0.2 0.2 0.2 0.2
## 
## [[3]]
## [1] 0.1666667 0.1666667 0.1666667 0.1666667 0.1666667 0.1666667
## 
## [[4]]
## [1] 0.25 0.25 0.25 0.25
## 
## [[5]]
## [1] 0.25 0.25 0.25 0.25
## 
## [[6]]
## [1] 0.1666667 0.1666667 0.1666667 0.1666667 0.1666667 0.1666667</code></pre>
<pre class="r"><code># quick plot
plot(ca.sp, border = &quot;grey60&quot;)
plot(ca_q_w, coords = ca.coords, add=T, col=2)</code></pre>
<p><img src="Lab_Week5_files/figure-html/unnamed-chunk-11-1.png" /><!-- --></p>
<pre class="r"><code># global moran&#39;s I using Monte Carlo
moran.mc(ca.sp$crate, ca_q_w, nsim=999, zero.policy= TRUE)</code></pre>
<pre><code>## 
##  Monte-Carlo simulation of Moran I
## 
## data:  ca.sp$crate 
## weights: ca_q_w  
## number of simulations + 1: 1000 
## 
## statistic = 0.41994, observed rank = 1000, p-value = 0.001
## alternative hypothesis: greater</code></pre>
<p><strong>Insert your interpretation here.</strong></p>
</div>
<div id="distance-50mi" class="section level2">
<h2>Distance, 50mi</h2>
<p>50 miles is 80467.2 meters.</p>
<pre class="r"><code>ca_nb_dist50 &lt;- dnearneigh(ca.coords, 
                           d1 = 0, 
                           d2 = 80467.2, 
                           row.names = ca.sp$county)

ca_nb_dist50_w &lt;-nb2listw(ca_nb_dist50, style=&quot;W&quot;, zero.policy= TRUE)</code></pre>
<p>Note, the <code>row.names</code> argument must be unique. So for the entire US, the <code>county</code> column is actually not unique. Try using <code>countyFIPS</code>.</p>
<pre class="r"><code># global moran&#39;s I using Monte Carlo
moran.mc(ca.sp$crate, ca_nb_dist50_w, nsim=999, zero.policy= TRUE)</code></pre>
<pre><code>## 
##  Monte-Carlo simulation of Moran I
## 
## data:  ca.sp$crate 
## weights: ca_nb_dist50_w  
## number of simulations + 1: 1000 
## 
## statistic = 0.19799, observed rank = 970, p-value = 0.03
## alternative hypothesis: greater</code></pre>
<p><strong>Insert your interpretation here.</strong></p>
</div>
<div id="distance-100mi" class="section level2">
<h2>Distance, 100mi</h2>
<p>100 mi is 160934.4 meters.</p>
<pre class="r"><code>ca_nb_dist100 &lt;- dnearneigh(ca.coords, 
                           d1 = 0, 
                           d2 = 160934.4, 
                           row.names = ca.sp$county)

ca_nb_dist100_w &lt;-nb2listw(ca_nb_dist50, style=&quot;W&quot;, zero.policy= TRUE)</code></pre>
<pre class="r"><code># global moran&#39;s I using Monte Carlo
moran.mc(ca.sp$crate, ca_nb_dist100_w, nsim=999, zero.policy= TRUE)</code></pre>
<pre><code>## 
##  Monte-Carlo simulation of Moran I
## 
## data:  ca.sp$crate 
## weights: ca_nb_dist100_w  
## number of simulations + 1: 1000 
## 
## statistic = 0.19799, observed rank = 989, p-value = 0.011
## alternative hypothesis: greater</code></pre>
<p><strong>Insert your interpretation here.</strong></p>
</div>
<div id="lisa" class="section level2">
<h2>LISA</h2>
<div id="queen" class="section level3">
<h3>Queen</h3>
<pre class="r"><code># lets get neighboods, ie spatial structure matrix, including selves
ca_q_nb.self &lt;- include.self(ca_q_nb)
# create weights matrix
ca_q_nb.self_w &lt;- nb2listw(ca_q_nb.self, style=&quot;W&quot;, zero.policy= TRUE)
# use G*
localgstar &lt;- localG(ca.sp$crate, ca_q_nb.self_w, zero.policy = TRUE)
# Examine summary values
summary(localgstar)</code></pre>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -2.76901 -1.52049  0.02529 -0.10387  1.08722  2.80376</code></pre>
<p><strong>Insert your interpretation here.</strong></p>
<pre class="r"><code># turn back into sf object for mapping
queen_sf &lt;- mutate(ca, localgstar = as.numeric(localgstar))</code></pre>
<pre class="r"><code># map with quintile
tm_shape(queen_sf, unit = &quot;mi&quot;) +
  tm_polygons(col = &quot;localgstar&quot;, 
              title = &quot;Gi* value&quot;,
              palette = &quot;-RdBu&quot;, 
              style = &quot;quantile&quot;) +
  tm_scale_bar(breaks = c(0, 10, 20), text.size = 1) +
  tm_layout(frame = F, main.title = &quot;Queen Continguity&quot;,
            legend.outside = T) </code></pre>
<pre><code>## Variable &quot;localgstar&quot; contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
<p><img src="Lab_Week5_files/figure-html/unnamed-chunk-19-1.png" /><!-- --></p>
</div>
<div id="dist-50mi" class="section level3">
<h3>Dist 50mi</h3>
<pre class="r"><code>ca_nb_dist50.self &lt;- include.self(ca_nb_dist50)
ca_nb_dist50.self_w &lt;- nb2listw(ca_nb_dist50.self , style=&quot;W&quot;, zero.policy= TRUE)
localgstar &lt;- localG(ca.sp$crate, ca_nb_dist50.self_w, zero.policy = TRUE)
summary(localgstar)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -2.2674 -1.1579 -0.1851 -0.1357  0.9700  2.3396</code></pre>
<p><strong>Insert your interpretation here.</strong></p>
<pre class="r"><code>dist50_sf &lt;- mutate(ca, localgstar = as.numeric(localgstar))</code></pre>
<pre class="r"><code># map with decile
tm_shape(dist50_sf, unit = &quot;mi&quot;) +
  tm_polygons(col = &quot;localgstar&quot;, 
              title = &quot;Gi* value&quot;,
              palette = &quot;-RdBu&quot;, 
              style = &quot;quantile&quot;,
              n = 10) +
  tm_scale_bar(breaks = c(0, 10, 20), text.size = 1) +
  tm_layout(frame = F, main.title = &quot;Distance 50 mi&quot;,
            legend.outside = T) </code></pre>
<pre><code>## Variable &quot;localgstar&quot; contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
<p><img src="Lab_Week5_files/figure-html/unnamed-chunk-22-1.png" /><!-- --></p>
</div>
<div id="dist-100mi" class="section level3">
<h3>Dist 100mi</h3>
<pre class="r"><code>ca_nb_dist100.self &lt;- include.self(ca_nb_dist100)
ca_nb_dist100.self_w &lt;- nb2listw(ca_nb_dist100.self , style=&quot;W&quot;, zero.policy= TRUE)
localgstar &lt;- localG(ca.sp$crate, ca_nb_dist100.self_w, zero.policy = TRUE)
summary(localgstar)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -3.6885 -2.0339 -0.2704 -0.4514  0.9357  2.3869</code></pre>
<p><strong>Insert your interpretation here.</strong></p>
<pre class="r"><code>dist100_sf &lt;- mutate(ca, localgstar = as.numeric(localgstar))</code></pre>
<pre class="r"><code>breaks &lt;- c(-Inf, -2.58, -1.96, -1.65, 1.65, 1.96, 2.58, Inf)

# map with z-scores as break
tm_shape(dist100_sf, unit = &quot;mi&quot;) +
  tm_polygons(col = &quot;localgstar&quot;, title = &quot;Gi* value&quot;, palette = &quot;-RdBu&quot;,
              breaks = breaks) +
  tm_scale_bar(breaks = c(0, 10, 20), text.size = 1) +
  tm_layout(frame = F, main.title = &quot;Distance 100 mi&quot;,
            legend.outside = T)</code></pre>
<pre><code>## Variable &quot;localgstar&quot; contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
<p><img src="Lab_Week5_files/figure-html/unnamed-chunk-25-1.png" /><!-- --></p>
</div>
</div>
</div>
<div id="part-ii" class="section level1">
<h1>Part II</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>Read BBR p 182-3 on residuals and p 174-7 beginning with “Estimation of a Linear Regression Function” for an introduction on fitting a line.</p>
<p>Also, these may be useful references as well from Statistics by Jim: <a href="https://statisticsbyjim.com/glossary/fitted-values/">fitted values</a> and <a href="https://statisticsbyjim.com/glossary/residuals/">residuals</a>.</p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Again, BBR p174 should be useful in answering this question.</p>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>Use equation 4-4 and the values reported under “Coefficients” and “Estimate” when running <code>summary(lm1)</code>.</p>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>The simplest way to do this in R would be to use two functions followed by each other in the same code chunk, <code>plot</code> and <code>lines</code>, like so:</p>
<pre class="r"><code>plot(your_response_variable ~ your_independent_variable, your_data_frame)
lines(your_data_frame$your_response_variable, 
      predict(your_lm_object), 
      col = &quot;blue&quot;)</code></pre>
<p>Replace all the arguments beginning with <code>your_</code> with the appropriate names.</p>
</div>
<div id="question-5" class="section level2">
<h2>Question 5</h2>
<p>Where does the <em>name</em> <code>poorPoor</code> actually come from? Well because the <code>poor</code> column in <code>zctanyc</code> is qualitative, the output for the <code>Poor</code> category in the column <code>poor</code> is given the prefix <code>poor</code>. You’ll see in the next question, when running <code>lm</code> on the <code>borough</code> column, a similar naming scheme: “boroughBrooklyn”, “boroughQueens”, etc.</p>
<p>For more information on interpeting the “Coefficients” in the summary output of <code>lm</code>, check out this article on <a href="http://www.sthda.com/english/articles/40-regression-analysis/163-regression-with-categorical-variables-dummy-coding-essentials-in-r/">Regression with Categorical Variables</a>.</p>
</div>
<div id="question-6" class="section level2">
<h2>Question 6</h2>
<p>See Question 5.</p>
</div>
<div id="question-7" class="section level2">
<h2>Question 7</h2>
<p>The r^2 is described beginning on the bottom of p. 182 in BBR. This <a href="https://statisticsbyjim.com/regression/interpret-r-squared-regression/">article</a> may be of use as well.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>


</body>
</html>
